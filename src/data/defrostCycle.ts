// 제상 사이클 가이드
export interface DefrostMethod {
  설명: string
  원리: string
  히터용량?: string
  적용온도: string
  장점: string[]
  단점: string[]
  주의사항: string
}

export interface DefrostTiming {
  저장온도: string
  제상간격: string
  제상시간: string
  종료온도: string
  비고?: string
}

export interface DrainManagement {
  항목: string
  사양: string
  목적: string
  점검주기: string
}

export interface DefrostTroubleshooting {
  증상: string
  원인: string[]
  조치: string[]
  예방: string
}

export const DEFROST_METHODS: Record<string, DefrostMethod> = {
  "전열 제상": {
    설명: "Electric Defrost - 전기 히터를 이용한 제상",
    원리: "증발기에 전기 히터를 설치하여 직접 가열",
    히터용량: "200~500W/m² 증발기",
    적용온도: "냉동고 (-20°C 이하)",
    장점: [
      "확실한 제상 효과",
      "구조가 단순하고 제어 용이",
      "설치 비용 저렴",
      "소형 냉동기에 적합"
    ],
    단점: [
      "전력 소비량 높음",
      "제상 중 고내 온도 상승",
      "히터 고장 시 제상 불가",
      "제상 수분의 재동결 위험"
    ],
    주의사항: "제상 종료 온도 센서(Termination Thermostat) 필수 - 과열 방지"
  },
  "핫가스 제상": {
    설명: "Hot Gas Defrost - 압축기 토출 고온가스 활용",
    원리: "압축기 토출가스를 증발기로 우회시켜 제상",
    적용온도: "대형 냉동창고 (-25°C ~ -40°C)",
    장점: [
      "에너지 효율 높음 (30~50% 절감)",
      "빠른 제상 (전열 대비 40% 단축)",
      "대용량 설비에 유리",
      "운전 중 제상 가능"
    ],
    단점: [
      "배관 시스템 복잡",
      "초기 설치비 높음",
      "제어 밸브 고장 시 액압축 위험",
      "제상 후 드레인 동결 주의"
    ],
    주의사항: "⚠️ 액분리기(Accumulator) 필수 - 제상 종료 시 액냉매 유입 방지"
  },
  "자연 제상": {
    설명: "Off-Cycle Defrost - 압축기 정지 후 실내 공기로 제상",
    원리: "압축기를 정지하고 송풍기만 운전하여 실내 공기로 제상",
    적용온도: "냉장고 (0°C ~ 5°C)",
    장점: [
      "에너지 소비 없음",
      "구조 매우 단순",
      "설치 비용 최저",
      "고장 요인 적음"
    ],
    단점: [
      "제상 시간 길음 (30~60분)",
      "저온 냉동에 부적합",
      "습도 높은 환경에서 비효율",
      "제상 중 온도 상승 큼"
    ],
    주의사항: "증발기 코일 온도 +5°C 이상 확인 필수 (온도 센서로 자동 제어)"
  },
  "물 제상": {
    설명: "Water Defrost - 물 분무로 제상",
    원리: "증발기에 온수 또는 냉수를 분무하여 성에 제거",
    적용온도: "수산물 저온저장고 (-5°C ~ 0°C)",
    장점: [
      "제상 속도 매우 빠름 (5~10분)",
      "에너지 효율 우수",
      "대형 시설에 적합",
      "제상 후 즉시 냉각 가능"
    ],
    단점: [
      "물 공급 시스템 필요",
      "배수 처리 복잡",
      "부식 위험",
      "수질 관리 필요"
    ],
    주의사항: "배수 트랩 동결 방지 필수 - 드레인 라인 히터 설치"
  },
  "역사이클 제상": {
    설명: "Reverse Cycle Defrost - 냉동 사이클을 역전시켜 제상",
    원리: "4방 밸브로 냉매 흐름을 역전시켜 증발기를 응축기로 작동",
    적용온도: "히트펌프형 냉동기",
    장점: [
      "추가 에너지 불요",
      "제상 효율 높음",
      "자동 제어 용이",
      "실외기 제상에 최적"
    ],
    단점: [
      "4방 밸브 추가 필요",
      "제어 복잡",
      "실내 온도 저하",
      "잦은 사이클 전환 시 밸브 수명 단축"
    ],
    주의사항: "제상 모드 전환 시 압력 평형 대기 (1~2분) 필요"
  }
}

export const DEFROST_TIMING: DefrostTiming[] = [
  {
    저장온도: "냉장 (0~5°C)",
    제상간격: "6~8시간",
    제상시간: "15~20분",
    종료온도: "+5°C",
    비고: "자연 제상 권장"
  },
  {
    저장온도: "냉동 (-18~-20°C)",
    제상간격: "4~6시간",
    제상시간: "20~30분",
    종료온도: "+10°C",
    비고: "전열 또는 핫가스 제상"
  },
  {
    저장온도: "초저온 (-30~-35°C)",
    제상간격: "6~8시간",
    제상시간: "30~45분",
    종료온도: "+15°C",
    비고: "핫가스 제상 권장"
  },
  {
    저장온도: "급속냉동 (-40°C 이하)",
    제상간격: "8~12시간",
    제상시간: "40~60분",
    종료온도: "+15~+20°C",
    비고: "핫가스 제상 + 보조 히터"
  },
  {
    저장온도: "수산물 저장고 (-5~0°C)",
    제상간격: "4~6시간",
    제상시간: "5~15분",
    종료온도: "+5°C",
    비고: "물 제상 또는 자연 제상"
  }
]

export const DRAIN_MANAGEMENT: DrainManagement[] = [
  {
    항목: "드레인 팬 히터",
    사양: "20~50W (냉동고), 10~20W (냉장고)",
    목적: "드레인 팬 내 수분 동결 방지",
    점검주기: "월 1회 히터 작동 확인"
  },
  {
    항목: "드레인 라인 단열",
    사양: "단열재 두께 25mm 이상, 보온등급 1종",
    목적: "배수 라인 동결 방지",
    점검주기: "분기 1회 단열 상태 확인"
  },
  {
    항목: "드레인 라인 히터",
    사양: "5~10W/m (라인 길이에 따라)",
    목적: "장거리 배수 라인 동결 방지",
    점검주기: "제상 시 배수 흐름 확인"
  },
  {
    항목: "드레인 트랩",
    사양: "U트랩 깊이 50mm 이상 (고내 압력에 따라)",
    목적: "고내 공기 누출 방지, 배수 원활화",
    점검주기: "월 1회 트랩 청소 및 배수 테스트"
  },
  {
    항목: "드레인 필터",
    사양: "스테인리스 메시 필터 (1mm 이하)",
    목적: "이물질 유입 방지",
    점검주기: "주 1회 필터 청소"
  },
  {
    항목: "배수 점검구",
    사양: "50mm 이상 개구부",
    목적: "막힘 시 청소 용이",
    점검주기: "제상 후 배수 확인"
  }
]

export const DEFROST_TROUBLESHOOTING: Record<string, DefrostTroubleshooting> = {
  "제상 불량 (성에 잔류)": {
    증상: "제상 후에도 증발기에 성에가 남아있음, 냉각 능력 저하",
    원인: [
      "제상 시간 부족 (타이머 설정 오류)",
      "제상 히터 단선 또는 용량 부족",
      "제상 종료 센서 불량 (조기 종료)",
      "핫가스 밸브 작동 불량",
      "증발기 코일 과다 결빙"
    ],
    조치: [
      "1. 제상 타이머 설정 확인 (시간 연장)",
      "2. 히터 저항 측정 (단선 확인)",
      "3. 종료 센서 위치 및 설정 온도 확인",
      "4. 핫가스 밸브 수동 개방 테스트",
      "5. 제상 간격 단축 (4시간 → 3시간)"
    ],
    예방: "제상 간격 및 시간을 현장 조건에 맞게 최적화"
  },
  "과다 성에 발생": {
    증상: "제상 주기가 짧아도 성에가 빨리 발생, 냉각 불량",
    원인: [
      "문 패킹 불량 (외부 공기 침입)",
      "증발기 팬 과다 운전",
      "고내 습도 과다 (제품 수분)",
      "제상 간격 과다",
      "외부 공기 침투 (틈새, 환기구)"
    ],
    조치: [
      "1. 문 패킹 교체 (균열, 변형 확인)",
      "2. 에어커튼 설치 또는 보강",
      "3. 제품 포장 상태 점검 (수분 차단)",
      "4. 제상 간격 단축 (6시간 → 4시간)",
      "5. 고내 틈새 실링 작업"
    ],
    예방: "일일 문 개폐 횟수 및 시간 최소화, 정기 패킹 점검"
  },
  "드레인 동결": {
    증상: "제상 수가 배출되지 않고 드레인 팬에 얼음 축적",
    원인: [
      "드레인 팬 히터 불량",
      "드레인 라인 단열 부족",
      "배수 라인 막힘 (이물질)",
      "트랩 동결",
      "배수 경사 부족"
    ],
    조치: [
      "1. 드레인 팬 히터 전압 측정 (정상 작동 확인)",
      "2. 라인 히터 추가 설치",
      "3. 드레인 라인 해동 후 청소",
      "4. 트랩 위치 재설정 (고내 외부로 이동)",
      "5. 배수 경사 1/50 이상 확보"
    ],
    예방: "제상 종료 후 5분간 팬 히터 연장 운전 (수분 완전 배출)"
  },
  "제상 중 고내 온도 급상승": {
    증상: "제상 중 고내 온도가 허용 범위 초과 (+10°C 이상)",
    원인: [
      "제상 시간 과다",
      "송풍기 미정지 (온풍 순환)",
      "단열 성능 불량",
      "제상 히터 과용량",
      "제상 빈도 과다"
    ],
    조치: [
      "1. 제상 시간 단축 (30분 → 20분)",
      "2. 제상 중 송풍기 정지 설정 확인",
      "3. 단열재 두께 및 상태 점검",
      "4. 히터 용량 재계산 (300W/m² 이하)",
      "5. 제상 간격 조정 (4시간 → 6시간)"
    ],
    예방: "제상 종료 센서를 증발기 중앙부에 설치 (+5~+10°C 설정)"
  },
  "제상 후 냉각 복귀 지연": {
    증상: "제상 완료 후 고내 온도가 설정 온도까지 복귀하는 시간이 길어짐",
    원인: [
      "제상 후 증발기 온도 과다 상승",
      "압축기 재시동 지연",
      "냉매 충전량 부족",
      "증발기 팬 미작동",
      "팽창밸브 개도 부족"
    ],
    조치: [
      "1. 제상 종료 온도 하향 (+15°C → +10°C)",
      "2. 압축기 재시동 타이머 확인 (3분 → 1분)",
      "3. 냉매 충전량 점검 (과열도 확인)",
      "4. 송풍기 릴레이 및 모터 점검",
      "5. TXV 감온통 위치 및 개도 조정"
    ],
    예방: "제상 종료 후 송풍기 30초 먼저 기동, 압축기 1분 후 기동"
  },
  "헌팅 (제상 주기 불안정)": {
    증상: "제상이 자동 시작/종료를 반복하거나 시간이 불규칙",
    원인: [
      "제상 타이머 고장",
      "종료 센서 오작동 (감도 과다)",
      "제어 기판 불량",
      "전원 전압 불안정",
      "센서 배선 단선/접촉 불량"
    ],
    조치: [
      "1. 타이머 교체 (기계식 → 디지털식)",
      "2. 종료 센서 교정 또는 교체",
      "3. 제어 기판 펌웨어 업데이트",
      "4. 전원 전압 측정 (±10% 이내 확인)",
      "5. 센서 배선 재시공 (차폐 케이블 사용)"
    ],
    예방: "정기 점검 시 센서 및 타이머 작동 테스트 실시"
  },
  "드레인 팬 오버플로우": {
    증상: "제상 수가 드레인 팬을 넘쳐 고내로 역류",
    원인: [
      "드레인 라인 완전 막힘",
      "드레인 팬 용량 부족",
      "제상 수 과다 발생",
      "배수 펌프 고장 (펌프식 배수)"
    ],
    조치: [
      "1. 드레인 라인 고압 세척",
      "2. 드레인 팬 용량 확대",
      "3. 제상 간격 재조정 (성에량 감소)",
      "4. 배수 펌프 교체 또는 수리"
    ],
    예방: "월 1회 드레인 라인 예방 청소 (베이킹소다 + 온수)"
  }
}

// 제상 효율 계산 도구
export interface DefrostEfficiency {
  제상방식: string
  전력소비량: string // kWh/회
  제상시간: string // 분
  에너지비용: string // 원/회 (전기료 100원/kWh 기준)
  연간비용: string // 원/년 (1일 4회 기준)
}

export const DEFROST_EFFICIENCY: DefrostEfficiency[] = [
  {
    제상방식: "전열 제상 (5HP 냉동기)",
    전력소비량: "3.0 kWh/회",
    제상시간: "30분",
    에너지비용: "300원/회",
    연간비용: "438,000원/년"
  },
  {
    제상방식: "핫가스 제상 (5HP 냉동기)",
    전력소비량: "1.8 kWh/회",
    제상시간: "20분",
    에너지비용: "180원/회",
    연간비용: "262,800원/년"
  },
  {
    제상방식: "자연 제상 (냉장고)",
    전력소비량: "0 kWh/회",
    제상시간: "45분",
    에너지비용: "0원/회",
    연간비용: "0원/년"
  },
  {
    제상방식: "물 제상 (대형 창고)",
    전력소비량: "0.5 kWh/회 (펌프)",
    제상시간: "10분",
    에너지비용: "50원/회",
    연간비용: "73,000원/년"
  }
]

// 제상 주기 최적화 가이드
export const DEFROST_OPTIMIZATION = {
  원칙: [
    "성에 두께 3mm 이하 유지 (열교환 효율 90% 이상)",
    "제상 간격은 성에 발생 속도에 맞춰 조정",
    "제상 시간은 종료 센서로 자동 제어 (과제상 방지)",
    "제상 중 송풍기 정지로 온풍 순환 차단"
  ],
  절감팁: [
    "✅ 에어커튼 설치로 외부 습기 침입 50% 차단",
    "✅ 문 패킹 정기 교체로 기밀성 유지",
    "✅ 제상 타이밍을 야간 저렴한 전기료 시간대로 설정",
    "✅ 핫가스 제상 전환 시 연간 40% 에너지 절감",
    "✅ 드레인 히터 용량 최적화 (과용량 제거)"
  ],
  체크포인트: [
    "제상 간격이 2시간 이하로 짧아졌다 → 외부 공기 침투 점검",
    "제상 후 바로 성에 재발생 → 문 개폐 빈도 과다 또는 패킹 불량",
    "제상 시간이 1시간 이상 → 히터 용량 부족 또는 센서 불량",
    "드레인 동결 반복 → 팬 히터 용량 부족 또는 라인 단열 불량"
  ]
}
